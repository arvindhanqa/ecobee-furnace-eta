@using EcobeeFurnaceEta.Blazor.Models

<div class="card card-projection">
    <div class="card-header">
        <div class="card-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/>
            </svg>
        </div>
        <span class="card-title">Tomorrow Forecast</span>
    </div>
    <div class="card-body">
        <div class="projection-display">
            <span class="projection-value">@Stats.FormattedProjectedRuntime</span>
            <span class="projection-label">projected runtime</span>
        </div>
        <div class="projection-details">
            <div class="projection-row">
                <span class="projection-label">Forecast temp:</span>
                <span class="projection-stat">@Stats.ForecastedAvgTempTomorrow.ToString("F1")Â°F</span>
            </div>
            @{
                var diff = Stats.ProjectedHeatingMinutesTomorrow - Stats.TotalHeatingMinutes24h;
                var diffPercent = Stats.TotalHeatingMinutes24h > 0
                    ? (diff * 100.0 / Stats.TotalHeatingMinutes24h)
                    : 0;
            }
            <div class="projection-row">
                <span class="projection-label">vs today:</span>
                <span class="projection-stat @(diff > 0 ? "increase" : diff < 0 ? "decrease" : "")">
                    @(diff > 0 ? "+" : "")@diff min (@(diffPercent > 0 ? "+" : "")@diffPercent.ToString("F0")%)
                </span>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public RuntimeStats Stats { get; set; } = new();
}
